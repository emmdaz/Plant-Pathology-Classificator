[W 2025-11-06 22:03:13,433] Trial 0 failed with parameters: {'Kernel_1': 74, 'Kernel_Size_1': 3, 'Activation_1': 'selu', 'Regularizer': 'L2', 'regularizer_value': 3.7045539144082377e-06, 'regularizer_value_2': 7.844008800205617e-06, 'n_layers': 25, 'Kernel_2': 53, 'Kernel_Size_2': 3, 'Activation_2': 'leaky_relu', 'Dropout_L2': 'n', 'Dropout_value_L2': 0.20796416178028257, 'Kernel_3': 41, 'Kernel_Size_3': 7, 'Activation_3': 'relu6', 'Dropout_L3': 'y', 'Dropout_value_L3': 0.3047285581907521, 'Kernel_4': 128, 'Kernel_Size_4': 3, 'Activation_4': 'selu', 'Dropout_L4': 'y', 'Dropout_value_L4': 0.49703800493735983, 'Kernel_5': 86, 'Kernel_Size_5': 10, 'Activation_5': 'relu6', 'Dropout_L5': 'n', 'Dropout_value_L5': 0.44423525044465445, 'Kernel_6': 120, 'Kernel_Size_6': 7, 'Activation_6': 'relu', 'Dropout_L6': 'n', 'Dropout_value_L6': 0.2355650290976348, 'Kernel_7': 100, 'Kernel_Size_7': 7, 'Activation_7': 'relu6', 'Dropout_L7': 'y', 'Dropout_value_L7': 0.48583702669385936, 'Kernel_8': 123, 'Kernel_Size_8': 8, 'Activation_8': 'relu6', 'Dropout_L8': 'y', 'Dropout_value_L8': 0.41216039180606767, 'Kernel_9': 88, 'Kernel_Size_9': 8, 'Activation_9': 'leaky_relu', 'Dropout_L9': 'n', 'Dropout_value_L9': 0.25295118919798304, 'Kernel_10': 76, 'Kernel_Size_10': 3, 'Activation_10': 'leaky_relu', 'Dropout_L10': 'y', 'Dropout_value_L10': 0.40319598227675935, 'Kernel_11': 50, 'Kernel_Size_11': 7, 'Activation_11': 'leaky_relu', 'Dropout_L11': 'n', 'Dropout_value_L11': 0.3201509352034507, 'Kernel_12': 25, 'Kernel_Size_12': 3, 'Activation_12': 'relu6', 'Dropout_L12': 'y', 'Dropout_value_L12': 0.23498545671602156, 'Kernel_13': 107, 'Kernel_Size_13': 8, 'Activation_13': 'relu', 'Dropout_L13': 'y', 'Dropout_value_L13': 0.3808093926744378, 'Kernel_14': 87, 'Kernel_Size_14': 10, 'Activation_14': 'selu', 'Dropout_L14': 'y', 'Dropout_value_L14': 0.4488273611853684, 'Kernel_15': 45, 'Kernel_Size_15': 3, 'Activation_15': 'relu', 'Dropout_L15': 'y', 'Dropout_value_L15': 0.444675920639849, 'Kernel_16': 18, 'Kernel_Size_16': 3, 'Activation_16': 'relu6', 'Dropout_L16': 'n', 'Dropout_value_L16': 0.3270262495600969, 'Kernel_17': 42, 'Kernel_Size_17': 8, 'Activation_17': 'relu6', 'Dropout_L17': 'y', 'Dropout_value_L17': 0.4566983262589644, 'Kernel_18': 74, 'Kernel_Size_18': 7, 'Activation_18': 'leaky_relu', 'Dropout_L18': 'n', 'Dropout_value_L18': 0.40309719070638383, 'Kernel_19': 117, 'Kernel_Size_19': 3, 'Activation_19': 'relu6', 'Dropout_L19': 'y', 'Dropout_value_L19': 0.2087779420784776, 'Kernel_20': 13, 'Kernel_Size_20': 7, 'Activation_20': 'relu6', 'Dropout_L20': 'y', 'Dropout_value_L20': 0.34846301966712206, 'Kernel_21': 26, 'Kernel_Size_21': 10, 'Activation_21': 'relu6', 'Dropout_L21': 'y', 'Dropout_value_L21': 0.40842639695626226, 'Kernel_22': 16, 'Kernel_Size_22': 10, 'Activation_22': 'relu6', 'Dropout_L22': 'y', 'Dropout_value_L22': 0.30983826799174413, 'Kernel_23': 118, 'Kernel_Size_23': 10, 'Activation_23': 'relu6', 'Dropout_L23': 'n', 'Dropout_value_L23': 0.301295840848174, 'Kernel_24': 89, 'Kernel_Size_24': 7, 'Activation_24': 'relu6', 'Dropout_L24': 'n', 'Dropout_value_L24': 0.34085939604982185, 'Kernel_25': 58, 'Kernel_Size_25': 8, 'Activation_25': 'relu6', 'Dropout_L25': 'n', 'Dropout_value_L25': 0.31556427240391244, 'Kernel_26': 18, 'Kernel_Size_26': 3, 'Activation_26': 'relu6', 'Dropout_L26': 'n', 'Dropout_value_L26': 0.37093761551097876, 'learning_rate': 0.0023305466173599446, 'optimizer': 'sgd'} because of the following error: ResourceExhaustedError().
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "<ipython-input-10-ea9bb41918fa>", line 176, in objective
    history = model.fit(
  File "/usr/local/lib/python3.8/dist-packages/wandb/integration/keras/keras.py", line 171, in new_v2
    return old_v2(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/wandb/integration/keras/keras.py", line 171, in new_v2
    return old_v2(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/wandb/integration/keras/keras.py", line 171, in new_v2
    return old_v2(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/usr/local/lib/python3.8/dist-packages/tensorflow/python/eager/execute.py", line 54, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError: Graph execution error:

Detected at node 'model/conv2d_2/Conv2D' defined at (most recent call last):
    File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
      return _run_code(code, main_globals, None,
    File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
      exec(code, run_globals)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel_launcher.py", line 16, in <module>
      app.launch_new_instance()
    File "/usr/local/lib/python3.8/dist-packages/traitlets/config/application.py", line 976, in launch_instance
      app.start()
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/kernelapp.py", line 505, in start
      self.io_loop.start()
    File "/usr/local/lib/python3.8/dist-packages/tornado/platform/asyncio.py", line 215, in start
      self.asyncio_loop.run_forever()
    File "/usr/lib/python3.8/asyncio/base_events.py", line 570, in run_forever
      self._run_once()
    File "/usr/lib/python3.8/asyncio/base_events.py", line 1859, in _run_once
      handle._run()
    File "/usr/lib/python3.8/asyncio/events.py", line 81, in _run
      self._context.run(self._callback, *self._args)
    File "/usr/local/lib/python3.8/dist-packages/tornado/ioloop.py", line 687, in <lambda>
      lambda f: self._run_callback(functools.partial(callback, future))
    File "/usr/local/lib/python3.8/dist-packages/tornado/ioloop.py", line 740, in _run_callback
      ret = callback()
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 821, in inner
      self.ctx_run(self.run)
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 782, in run
      yielded = self.gen.send(value)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/kernelbase.py", line 378, in dispatch_queue
      yield self.process_one()
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 250, in wrapper
      runner = Runner(ctx_run, result, future, yielded)
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 748, in __init__
      self.ctx_run(self.run)
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 782, in run
      yielded = self.gen.send(value)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/kernelbase.py", line 365, in process_one
      yield gen.maybe_future(dispatch(*args))
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 234, in wrapper
      yielded = ctx_run(next, result)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/kernelbase.py", line 272, in dispatch_shell
      yield gen.maybe_future(handler(stream, idents, msg))
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 234, in wrapper
      yielded = ctx_run(next, result)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/kernelbase.py", line 540, in execute_request
      self.do_execute(
    File "/usr/local/lib/python3.8/dist-packages/tornado/gen.py", line 234, in wrapper
      yielded = ctx_run(next, result)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/ipkernel.py", line 294, in do_execute
      res = shell.run_cell(code, store_history=store_history, silent=silent)
    File "/usr/local/lib/python3.8/dist-packages/ipykernel/zmqshell.py", line 536, in run_cell
      return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py", line 2885, in run_cell
      result = self._run_cell(
    File "/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py", line 2940, in _run_cell
      return runner(coro)
    File "/usr/local/lib/python3.8/dist-packages/IPython/core/async_helpers.py", line 129, in _pseudo_sync_runner
      coro.send(None)
    File "/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py", line 3139, in run_cell_async
      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
    File "/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py", line 3318, in run_ast_nodes
      if await self.run_code(code, result, async_=asy):
    File "/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py", line 3378, in run_code
      exec(code_obj, self.user_global_ns, self.user_ns)
    File "<ipython-input-11-82283c7cb4b6>", line 2, in <module>
      study.optimize(objective, n_trials = 60)
    File "/usr/local/lib/python3.8/dist-packages/optuna/study/study.py", line 490, in optimize
      _optimize(
    File "/usr/local/lib/python3.8/dist-packages/optuna/study/_optimize.py", line 63, in _optimize
      _optimize_sequential(
    File "/usr/local/lib/python3.8/dist-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
      frozen_trial_id = _run_trial(study, func, catch)
    File "/usr/local/lib/python3.8/dist-packages/optuna/study/_optimize.py", line 201, in _run_trial
      value_or_values = func(trial)
    File "<ipython-input-10-ea9bb41918fa>", line 176, in objective
      history = model.fit(
    File "/usr/local/lib/python3.8/dist-packages/wandb/integration/keras/keras.py", line 171, in new_v2
      return old_v2(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/wandb/integration/keras/keras.py", line 171, in new_v2
      return old_v2(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/wandb/integration/keras/keras.py", line 171, in new_v2
      return old_v2(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/training.py", line 1564, in fit
      tmp_logs = self.train_function(iterator)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/training.py", line 1160, in train_function
      return step_function(self, iterator)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/training.py", line 1146, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/training.py", line 1135, in run_step
      outputs = model.train_step(data)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/training.py", line 993, in train_step
      y_pred = self(x, training=True)
    File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/training.py", line 557, in __call__
      return super().__call__(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/base_layer.py", line 1097, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 96, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/functional.py", line 510, in call
      return self._run_internal_graph(inputs, training=training, mask=mask)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/functional.py", line 667, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/engine/base_layer.py", line 1097, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/utils/traceback_utils.py", line 96, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.8/dist-packages/keras/layers/convolutional/base_conv.py", line 283, in call
      outputs = self.convolution_op(inputs, self.kernel)
    File "/usr/local/lib/python3.8/dist-packages/keras/layers/convolutional/base_conv.py", line 255, in convolution_op
      return tf.nn.convolution(
Node: 'model/conv2d_2/Conv2D'
OOM when allocating tensor with shape[30,74,256,256] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[{{node model/conv2d_2/Conv2D}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.
 [Op:__inference_train_function_20421]
[W 2025-11-06 22:03:13,435] Trial 0 failed with value None.
